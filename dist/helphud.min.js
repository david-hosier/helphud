/*! helphud 25-10-2013 */
!function(a,b){var c=function(){var a,b;1==arguments.length?(b=arguments[0],b instanceof c?(this.left=b.left,this.top=b.top,this.width=b.width,this.height=b.height):(a=b.offset(),this.left=a.left,this.top=a.top,this.width=b.outerWidth(),this.height=b.outerHeight())):4==arguments.length&&(this.left=arguments[0],this.top=arguments[1],this.width=arguments[2],this.height=arguments[3])};c.prototype.explode=function(a){return this.left-=a,this.top-=a,this.width+=2*a,this.height+=2*a,this},c.prototype.intersection=function(a){var b=this,d=a,e=Math.max(b.left,d.left),f=Math.min(b.left+b.width,d.left+d.width);if(f>=e){var g=Math.max(b.top,d.top),h=Math.min(b.top+b.height,d.top+d.height);if(h>=g)return new c(e,g,f-e,h-g)}return null},c.prototype.subtract=function(a){var b,d=this,e=a;if(null===d.intersection(e))return[new c(d)];b=[];var f=d.top,g=d.height,h=d.left+d.width,i=d.top+d.height,j=e.left+e.width,k=e.top+e.height;return e.top>d.top&&(b.push(new c(d.left,d.top,d.width,e.top-d.top)),f=e.top,g-=e.top-d.top),i>k&&(b.push(new c(d.left,k,d.width,i-k)),g=k-f),e.left>d.left&&b.push(new c(d.left,f,e.left-d.left,g)),h>j&&b.push(new c(j,f,h-j,g)),b},c.prototype.toString=function(){return"[Rect left="+this.left+", top="+this.top+", width="+this.width+", height="+this.height+"]"};var d=function(a){a instanceof c||(a=new c(a)),this.rects=[a]};d.prototype.each=function(a){for(var b=0;b<this.rects.length;b++)a.call(this,this.rects[b])},d.prototype.subtract=function(a){var b=[];a instanceof c||(a=new c(a)),this.each(function(c){for(var d=c.subtract(a),e=0;e<d.length;e++)b.push(d[e])}),this.rects=b},d.prototype.toString=function(){var a="[Plane ";return this.each(function(b){a+=b.toString()+" "}),a+"]"};var e=function(){a(b).off("resize.helphud");var c=a(".helphud-overlay");c.data("more")&&h(c.data("more")),c.find(".helphud-tooltip,[data-from]").each(function(){var b=a(this),c=a(b.data("from"));b.contents().each(function(){c.append(this)})}),a(".helphud-overlay").remove()},f=function(c){c.css({position:"absolute",top:Math.max(0,(a(b).height()-c.outerHeight())/2+a(b).scrollTop())+"px",left:Math.max(0,(a(b).width()-c.outerWidth())/2+a(b).scrollLeft())+"px"})},g=function(b){var c=a(".helphud-overlay");c.data("more",b);var d=a("<div class='helphud-more-mask'></div>");c.append(d);var e=a("<div class='helphud-more-container'><div class='helphud-more-body'></div><div class='helphud-more-commands'><a class='helphud-more-close' href='#'>Close</a></div></div>"),g=e.find(".helphud-more-body");a("#"+b).contents().each(function(){g.append(this)}),c.append(e),f(e)},h=function(){var b=a(".helphud-overlay"),c=a("#"+b.data("more")),d=b.find(".helphud-more-body");d.contents().each(function(){c.append(this)}),b.find(".helphud-more-mask").remove(),b.find(".helphud-more-container").remove(),b.removeData("more")},i=function(){var f={margin:3,stick:30,barrier:5},j=a("body"),k=this,l=new d(k),m=k.find("*[data-intro]"),n=a("<div class='helphud-overlay'></div>");n.on("click",function(b){var c=a(b.target),d=c.data("more");if(d)return g(d),b.preventDefault(),void 0;if(c.hasClass("helphud-more-close"))return h(),b.preventDefault(),void 0;var f=c.hasClass("helphud-ignore")||c.parents(".helphud-ignore").length>0||c.hasClass("helphud-more-container")||c.parents(".helphud-more-container").length>0||c.hasClass("helphud-more-mask");f===!1&&e()}),j.append(n),m.each(function(){l.subtract(new c(a(this)).explode(f.margin))}),l.each(function(b){var c=a("<div class='helphud-mask'></div>");c.css({left:b.left,top:b.top,width:b.width,height:b.height}),n.append(c)}),m.each(function(){var b=a(this),c=b.offset(),d=c.left-f.margin,e=c.top-f.margin,g=b.outerWidth()+2*f.margin,h=b.outerHeight()+2*f.margin,i=b.data("position")||"bottom",j=a("<div class='helphud-pointer' ></div>");switch(i){case"left":j.css({top:e,left:d-f.stick-f.barrier+"px",width:f.stick+"px",height:h}).addClass("helphud-pointer-left");break;case"right":j.css({top:e,left:d+g+f.barrier+"px",width:f.stick+"px",height:h}).addClass("helphud-pointer-right");break;case"top":j.css({top:e-f.stick-f.barrier+"px",left:d+"px",width:g+"px",height:f.stick+"px"}).addClass("helphud-pointer-top");break;default:j.css({top:e+h+f.barrier+"px",left:d+"px",width:g+"px",height:f.stick+"px"}).addClass("helphud-pointer-bottom")}n.append(j);var k=a("<div class='helphud-tooltip' style='left:-10000px'></div>"),l=b.data("intro");switch(l.length>0&&"#"===l.charAt(0)?(a(l).contents().each(function(){k.append(this)}),k.data("from",l)):k.html(b.data("intro")),n.append(k),i){case"left":k.css({top:e+h/2-k.outerHeight()/2+"px",left:d-f.barrier-f.stick-k.outerWidth()+"px"});break;case"right":k.css({top:e+h/2-k.outerHeight()/2+"px",left:d+g+f.barrier+f.stick+"px"});break;case"top":k.css({top:e-f.barrier-f.stick-k.outerHeight()+"px",left:d+g/2-k.outerWidth()/2+"px"});break;default:k.css({top:e+h+f.barrier+f.stick+"px",left:d+g/2-k.outerWidth()/2+"px"})}}),n.data("more")&&g(n.data("more")),a(b).on("resize.helphud",function(){var a=n.data("more");e(),i.apply(k),a&&g(a)})},j={show:i,hide:e};a.fn.helphud=function(b){return j[b]?j[b].apply(this,Array.prototype.slice.call(arguments,1)):(a.error("Method "+b+" does not exist on jQuery.modalize"),void 0)}}(jQuery,window);