/*! helphud 15-01-2014 */
!function(a,b){var c=function(){var a,b;1==arguments.length?(b=arguments[0],b instanceof c?(this.left=b.left,this.top=b.top,this.width=b.width,this.height=b.height):(a=b.offset(),this.left=a.left,this.top=a.top,this.width=b.outerWidth(),this.height=b.outerHeight())):4==arguments.length&&(this.left=arguments[0],this.top=arguments[1],this.width=arguments[2],this.height=arguments[3])};c.prototype.explode=function(a){return this.left-=a,this.top-=a,this.width+=2*a,this.height+=2*a,this},c.prototype.intersection=function(a){var b=this,d=a,e=Math.max(b.left,d.left),f=Math.min(b.left+b.width,d.left+d.width);if(f>=e){var g=Math.max(b.top,d.top),h=Math.min(b.top+b.height,d.top+d.height);if(h>=g)return new c(e,g,f-e,h-g)}return null},c.prototype.subtract=function(a){var b,d=this,e=a;if(null===d.intersection(e))return[new c(d)];b=[];var f=d.top,g=d.height,h=d.left+d.width,i=d.top+d.height,j=e.left+e.width,k=e.top+e.height;return e.top>d.top&&(b.push(new c(d.left,d.top,d.width,e.top-d.top)),f=e.top,g-=e.top-d.top),i>k&&(b.push(new c(d.left,k,d.width,i-k)),g=k-f),e.left>d.left&&b.push(new c(d.left,f,e.left-d.left,g)),h>j&&b.push(new c(j,f,h-j,g)),b},c.prototype.toString=function(){return"[Rect left="+this.left+", top="+this.top+", width="+this.width+", height="+this.height+"]"};var d=function(a){a instanceof c||(a=new c(a)),this.rects=[a]};d.prototype.each=function(a){for(var b=0;b<this.rects.length;b++)a.call(this,this.rects[b])},d.prototype.subtract=function(a){var b=[];a instanceof c||(a=new c(a)),this.each(function(c){for(var d=c.subtract(a),e=0;e<d.length;e++)b.push(d[e])}),this.rects=b},d.prototype.toString=function(){var a="[Plane ";return this.each(function(b){a+=b.toString()+" "}),a+"]"};var e=function(a,c){var d;return function(){d&&b.clearTimeout(d),d=b.setTimeout(function(){d=void 0,c()},a)}},f=function(){var b=a(".helphud-overlay"),c=b.data("container");c.removeClass("helphud-shown").trigger(a.Event("helphud-hidden")),b.fadeOut({complete:function(){g.apply(this,arguments)}})},g=function(){a(b).off(".helphud");var c=a(".helphud-overlay");c.data("container"),c.find(".helphud-panel").each(function(){var b=a(this),c=b.data("marker");b.toggle(!1),c.before(b).remove()}),c.data("more")&&j(c.data("more")),c.find(".helphud-tooltip,[data-from]").each(function(){var b=a(this),c=a(b.data("from"));b.contents().each(function(){c.append(this)})}),c.remove()},h=function(c){c.css({position:"absolute",top:Math.max(0,(a(b).height()-c.outerHeight())/2+a(b).scrollTop())+"px",left:Math.max(0,(a(b).width()-c.outerWidth())/2+a(b).scrollLeft())+"px"})},i=function(b){var c=a(".helphud-overlay");c.data("more",b);var d=a("<div class='helphud-more-mask'></div>");c.append(d);var e=a("<div class='helphud-more-container'><div class='helphud-more-body'></div><div class='helphud-more-commands'><a class='helphud-more-close' href='#'>Close</a></div></div>"),f=e.find(".helphud-more-body");a("#"+b).contents().each(function(){f.append(this)}),c.append(e),h(e)},j=function(){var b=a(".helphud-overlay"),c=a("#"+b.data("more")),d=b.find(".helphud-more-body");d.contents().each(function(){c.append(this)}),b.find(".helphud-more-mask").remove(),b.find(".helphud-more-container").remove(),b.removeData("more")},k=function(){var b=this;l.apply(this,arguments),a(".helphud-overlay").toggle(!1).fadeIn({complete:function(){b.addClass("helphud-shown").trigger(a.Event("helphud-shown"))}})},l=function(){var h={margin:3,stick:30,barrier:5},k=a("body"),m=this,n=new d(m),o=m.find("*[data-intro]:visible"),p=a("<div class='helphud-overlay'></div>");p.height(a(document).height()),p.on("click",function(b){var c,d=a(b.target),e=d.add(d.parentsUntil(".helphud-overlay"));if(e.each(function(){return c=a(this).data("more"),void 0===c}),c)return i(c),b.preventDefault(),void 0;var g=!1;if(e.each(function(){return g=a(this).hasClass("helphud-more-close"),g===!1}),g)return j(),b.preventDefault(),void 0;var h=d.hasClass("helphud-ignore")||d.parents(".helphud-ignore").length>0||d.hasClass("helphud-more-container")||d.parents(".helphud-more-container").length>0||d.hasClass("helphud-more-mask");h===!1&&f()}),p.data("container",m),k.append(p),o.each(function(){a(this).data("highlight")!==!1&&n.subtract(new c(a(this)).explode(h.margin))}),n.each(function(b){var c=a("<div class='helphud-mask'></div>");c.css({left:b.left,top:b.top,width:b.width,height:b.height}),p.append(c)}),o.each(function(){var b=a(this),c=b.offset(),d=c.left-h.margin,e=c.top-h.margin,f=b.outerWidth()+2*h.margin,g=b.outerHeight()+2*h.margin,i=b.data("position")||"bottom",j=a("<div class='helphud-pointer' ></div>");switch(i){case"left":j.css({top:e,left:d-h.stick-h.barrier+"px",width:h.stick+"px",height:g}).addClass("helphud-pointer-left");break;case"right":j.css({top:e,left:d+f+h.barrier+"px",width:h.stick+"px",height:g}).addClass("helphud-pointer-right");break;case"top":j.css({top:e-h.stick-h.barrier+"px",left:d+"px",width:f+"px",height:h.stick+"px"}).addClass("helphud-pointer-top");break;case"center":j=void 0;break;default:j.css({top:e+g+h.barrier+"px",left:d+"px",width:f+"px",height:h.stick+"px"}).addClass("helphud-pointer-bottom")}j&&p.append(j);var k=a("<div class='helphud-tooltip' style='left:-10000px'></div>"),l=b.data("intro");switch(l.length>0&&"#"===l.charAt(0)?(a(l).contents().each(function(){k.append(this)}),k.data("from",l)):k.html(b.data("intro")),p.append(k),i){case"left":k.css({top:e+g/2-k.outerHeight()/2+"px",left:d-h.barrier-h.stick-k.outerWidth()+"px"});break;case"right":k.css({top:e+g/2-k.outerHeight()/2+"px",left:d+f+h.barrier+h.stick+"px"});break;case"top":k.css({top:e-h.barrier-h.stick-k.outerHeight()+"px",left:d+f/2-k.outerWidth()/2+"px"});break;case"center":k.css({top:e+g/2-k.outerHeight()/2+"px",left:d+f/2-k.outerWidth()/2+"px"});break;default:k.css({top:e+g+h.barrier+h.stick+"px",left:d+f/2-k.outerWidth()/2+"px"})}}),p.data("more")&&i(p.data("more")),m.find(".helphud-panel").each(function(){var b=a(this);if(b.parent().is(":visible")){var c=a("<div class='helphud-marker'></div>");a(this).data("marker",c).before(c).appendTo(p).toggle(!0)}});var q=function(){var b=p.data("more");g.apply(m),l.apply(m),a(".helphud-overlay").toggle(!0),b&&i(b)};a(b).on("resize.helphud",e(100,q)).on("scroll.helphud",e(100,q))},m={show:k,hide:f};a.fn.helphud=function(b){return m[b]?m[b].apply(this,Array.prototype.slice.call(arguments,1)):(a.error("Method "+b+" does not exist on jQuery.helphud"),void 0)}}(jQuery,window);